<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Reasoning with Machines Lab</title>
    <link href="styles/index.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
    <link href="img/assets/rml_logo_black.jpg" rel="icon" type="image/x-icon"/>
    <style>
      /* Carousel + news headline styles (scoped to this page) */
      .carousel-container { max-width: 980px; margin: 28px auto; position: relative; }
      .carousel { position: relative; overflow: hidden; border-radius: 8px; box-shadow: 0 6px 18px rgba(0,0,0,0.08); background:#fff; }
      .carousel-track { display: flex; transition: transform 400ms ease; will-change: transform; }
      .carousel-slide { min-width: 100%; box-sizing: border-box; display: flex; align-items: stretch; }
      .carousel-slide img { width: 60%; height: 320px; object-fit: cover; display:block; border-right:1px solid rgba(0,0,0,0.04); }
      .carousel-slide .slide-text { padding: 18px 22px; width: 40%; display:flex; flex-direction:column; justify-content:center; }
      .carousel-slide .slide-text h3 { margin: 0 0 10px 0; font-size: 1.15rem; }
      .carousel-slide .slide-text p { margin:0; color: #444; line-height:1.35; }
      .carousel-button { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.95); border: none; padding: 8px 10px; cursor: pointer; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.12); font-size:20px; line-height:1; }
      .carousel-button:focus { outline: 3px solid #b3d4ff; }
      .carousel-prev { left: 10px; }
      .carousel-next { right: 10px; }
      .news-headlines { max-width: 980px; margin: 8px auto 56px; padding: 0 8px; display: none; }
      .news-list { list-style: none; padding: 0; margin: 0; display:flex; gap: 12px; flex-wrap:wrap; }
      .news-item { background:#fff; border-radius:6px; padding:10px 12px; box-shadow: 0 3px 8px rgba(0,0,0,0.04); flex:1 1 calc(50% - 16px); min-width:240px; }
      .news-date { display:block; font-size:0.82rem; color:#777; margin-bottom:6px; }
      @media (max-width:720px){
        .carousel-slide img{width:100%;height:220px;border-right:0}
        .carousel-slide .slide-text{width:100%;padding:12px}
        .carousel-track{flex-direction:column}
      }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="rml-logo">
                <picture>
                    <!-- Dark mode logo -->
                    <source
                        srcset="img/assets/rml_logo_white.jpg"
                        media="(prefers-color-scheme: dark)"
                    />

                    <!-- Light mode / default logo -->
                    <img
                        src="img/assets/rml_logo_black.jpg"
                        alt="Reasoning with Machines Lab logo"
                        class="lab-logo-img"
                    />
                </picture>
                <div class="lab-identity" style="text-align:left;">
                    <h1>Reasoning with Machines Lab</h1>
                    <p class="oxford-affiliation">University of Oxford</p>
                </div>
            </div>
            <nav class="nav" aria-label="Primary">
                <div class="nav-content">
                    <ul>
                    <li><a href="index.html" class="active">Research</a></li>
                    <li><a href="team.html">Team</a></li>
                    <li><a href="publications.html">Publications</a></li>
                    <li><a href="news.html">News</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="layout">
    <main class="container main-content">
    <!-- Carousel + News Headlines -->
    <section class="carousel-container" aria-label="Featured news carousel">
      <div id="carousel" class="carousel" aria-roledescription="carousel">
        <div id="carouselTrack" class="carousel-track"></div>
        <button id="carouselPrev" class="carousel-button carousel-prev" aria-label="Previous slide">‹</button>
        <button id="carouselNext" class="carousel-button carousel-next" aria-label="Next slide">›</button>
      </div>
    </section>
  </main>
 </div>
  <footer class="footer">
   <p>
    &copy; 2025 Reasoning with Machines Lab, University of Oxford.
   </p>
  </footer>
    <script>
    // Load and display news from JSON file and build a simple image carousel
    document.addEventListener('DOMContentLoaded', function() {
        fetch('news.json')
            .then(response => response.json())
            .then(data => {
                const carouselTrack = document.getElementById('carouselTrack');
                const prevBtn = document.getElementById('carouselPrev');
                const nextBtn = document.getElementById('carouselNext');

                if (!carouselTrack) {
                    console.error('Carousel elements not found');
                    return;
                }

                // Sort news by date (newest first) and take only top 6
                const sortedNews = (data.news || [])
                    .slice()
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 6)
                    .filter(item => item.featured);  // Only include featured items

                if (sortedNews.length === 0) {
                    carouselTrack.innerHTML = '<div class="carousel-slide"><div class="slide-text"><h3>No featured stories</h3><p>There are currently no featured stories to show.</p></div></div>';
                    return;
                }

                // Build carousel slides and news list items
                sortedNews.forEach((item, idx) => {
                    const imgSrc = item.image || item.thumbnail || 'img/news-placeholder.jpg';

                    // Carousel slide
                    const slide = document.createElement('div');
                    slide.className = 'carousel-slide';
                    slide.setAttribute('role', 'group');
                    slide.setAttribute('aria-roledescription', 'slide');
                    slide.setAttribute('aria-label', `${idx + 1} of ${sortedNews.length}`);
                    slide.innerHTML = `
                      <img src="${imgSrc}" alt="${(item.title || '').replace(/"/g,"'")}" />
                      <div class="slide-text">
                        <h3>${item.title || 'Untitled'}</h3>
                        <p>${item.text || ''}</p>
                      </div>
                    `;
                    carouselTrack.appendChild(slide);
                });

                // Carousel mechanics
                const slides = Array.from(carouselTrack.children);
                let currentIndex = 0;
                function updateCarousel() {
                    const offset = -currentIndex * 100;
                    carouselTrack.style.transform = `translateX(${offset}%)`;
                }

                function goNext() {
                    currentIndex = (currentIndex + 1) % slides.length;
                    updateCarousel();
                }
                function goPrev() {
                    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                    updateCarousel();
                }

                nextBtn.addEventListener('click', () => { goNext(); resetAutoAdvance(); });
                prevBtn.addEventListener('click', () => { goPrev(); resetAutoAdvance(); });

                // Keyboard navigation
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'ArrowRight') { goNext(); resetAutoAdvance(); }
                    if (e.key === 'ArrowLeft') { goPrev(); resetAutoAdvance(); }
                });

                // Auto-advance
                let autoTimer = setInterval(goNext, 6000);
                function resetAutoAdvance() { clearInterval(autoTimer); autoTimer = setInterval(goNext, 6000); }

                // Make carousel swipeable on touch devices
                let startX = null;
                carouselTrack.addEventListener('touchstart', function(e) { startX = e.touches[0].clientX; }, {passive:true});
                carouselTrack.addEventListener('touchend', function(e) {
                    if (startX === null) return;
                    const endX = e.changedTouches[0].clientX;
                    const dx = endX - startX;
                    if (Math.abs(dx) > 40) {
                        if (dx < 0) goNext(); else goPrev();
                        resetAutoAdvance();
                    }
                    startX = null;
                });

                // Initial draw
                updateCarousel();
            })
            .catch(error => {
                console.error('Error loading news:', error);
            });
    });
  </script>
 </body>
</html>
