<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Publications - Reasoning with Machines Lab
  </title>
    <link href="styles/index.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
 </head>
 <body>
  <header class="header">
        <div class="header-content">
            <div class="rml-logo">
                <!-- Placeholder image for the lab (replace placeholder-square.png with your square image) -->
                <picture>
                    <!-- Dark mode logo -->
                    <source
                        srcset="img/assets/rml_logo_white.jpg"
                        media="(prefers-color-scheme: dark)"
                    />

                    <!-- Light mode / default logo -->
                    <img
                        src="img/assets/rml_logo_black.jpg"
                        alt="Reasoning with Machines Lab logo"
                        class="lab-logo-img"
                    />
                </picture>
                <div class="lab-identity" style="text-align:left;">
                    <h1>Reasoning with Machines Lab</h1>
                    <p class="oxford-affiliation">University of Oxford</p>
                </div>
            </div>

            <!-- Nav moved into header for a compact layout -->
            <nav class="nav" aria-label="Primary">
                <div class="nav-content">
                    <ul>
                    <li><a href="index.html">Research</a></li>
                    <li><a href="team.html">Team</a></li>
                    <li><a href="publications.html" class="active">Publications</a></li>
                    <li><a href="news.html">News</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
            </nav>
        </div>
</header>
  <main class="container">
   <section class="section" id="publications">
    <div class="section-header">
     <h2 class="section-title">
      Recent Publications
     </h2>

    </div>

            <div class="publications-list" id="publications-list">
             <!-- Publications will be loaded dynamically -->
            </div>
   </section>
  </main>
  <footer class="footer">
   <p>
    &copy; 2025 Reasoning with Machines Lab, University of Oxford. All rights reserved.
   </p>
  </footer>
  <script>
   document.addEventListener('DOMContentLoaded', function() {
            const expandButtons = document.querySelectorAll('.expand-bio-button');

            expandButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Find the parent .team-member div
                    const teamMember = this.closest('.team-member');
                    if (!teamMember) return;

                    // Find the expandable content within this team member
                    const expandableContent = teamMember.querySelector('.member-expandable-content');
                    if (!expandableContent) return;

                    // Toggle the 'expanded' class which triggers CSS display change
                    expandableContent.classList.toggle('expanded');

                    // Update button text based on the state
                    if (expandableContent.classList.contains('expanded')) {
                        this.textContent = 'Read Less';
                    } else {
                        this.textContent = 'Read More';
                    }
                });
            });
        });
  </script>
  <script>
   document.addEventListener('DOMContentLoaded', function() {
        const modalOverlay = document.getElementById('teamMemberModal');
        if (!modalOverlay) {
            console.error("Modal overlay not found!");
            return;
        }
        const modalCloseButton = modalOverlay.querySelector('.modal-close-button');
        const modalMemberNameElem = document.getElementById('modalMemberName');
        const modalMemberRoleElem = document.getElementById('modalMemberRole');
        const modalMemberBioElem = document.getElementById('modalMemberBio');
        const modalMemberContactLinksElem = document.getElementById('modalMemberContactLinks');
        const modalPhotoPlaceholderElem = modalOverlay.querySelector('.modal-photo-placeholder');

        // Make each .team-member card clickable (except if clicking a link inside)
        const teamMemberDivs = document.querySelectorAll('.team-member');

        teamMemberDivs.forEach(div => {
            div.style.cursor = 'pointer';
            div.addEventListener('click', function(event) {
            // Prevent modal if clicking a link inside the card
            if (event.target.tagName === 'A') return;
                const teamMemberDiv = this.closest('.team-member');

                // Get data from the team member card
                const name = teamMemberDiv.querySelector('.member-name').textContent;
                const role = teamMemberDiv.querySelector('.member-role').textContent;
                
                // Get photo content from the card: prefer <img> if present, else use text content
                const photoDiv = teamMemberDiv.querySelector('.member-photo');
                const imgElem = photoDiv ? photoDiv.querySelector('img') : null;
                // Store the card's photo content for fallback use later
                let cardPhotoContent = '';
                // Clear previous modal photo content
                modalPhotoPlaceholderElem.innerHTML = '';
                if (imgElem && imgElem.src) {
                    // If there's an image, clone it and set correct styles
                    const modalImg = document.createElement('img');
                    modalImg.src = imgElem.src;
                    modalImg.alt = imgElem.alt || name;
                    modalImg.style.width = '100%';
                    modalImg.style.height = '100%';
                    modalImg.style.objectFit = 'cover';
                    modalImg.style.borderRadius = '50%';
                    modalPhotoPlaceholderElem.appendChild(modalImg);
                    cardPhotoContent = ''; // No placeholder text if image is present
                } else if (photoDiv) {
                    // Otherwise, use the text content (e.g., [Photo Placeholder])
                    modalPhotoPlaceholderElem.textContent = photoDiv.textContent;
                    cardPhotoContent = photoDiv.textContent;
                }

                // Get hidden detailed content
                const fullDetailsDiv = teamMemberDiv.querySelector('.member-full-details');
                if (!fullDetailsDiv) {
                    console.error("Full details div not found for this team member.", teamMemberDiv);
                    return;
                }
                const bioHtml = fullDetailsDiv.querySelector('.member-bio').innerHTML;
                const contactLinksHtml = fullDetailsDiv.querySelector('.member-contact-links').innerHTML;

                // Populate modal
                if(modalMemberNameElem) modalMemberNameElem.textContent = name;
                if(modalMemberRoleElem) modalMemberRoleElem.textContent = role;
                if(modalMemberBioElem) modalMemberBioElem.innerHTML = bioHtml;
                if(modalMemberContactLinksElem) modalMemberContactLinksElem.innerHTML = contactLinksHtml;

                // Show modal
                modalOverlay.classList.add('active');
                document.body.style.overflow = 'hidden'; // Prevent background scroll
            });
        });

        // Close modal actions
        function closeModal() {
            modalOverlay.classList.remove('active');
            document.body.style.overflow = ''; // Restore background scroll
        }

        if(modalCloseButton) modalCloseButton.addEventListener('click', closeModal);

        modalOverlay.addEventListener('click', function(event) {
            // Only close if clicked on the overlay itself, not the content
            if (event.target === modalOverlay) {
                closeModal();
            }
        });

        // Optional: Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && modalOverlay.classList.contains('active')) {
                closeModal();
            }
        });
    });
  </script>
  <script>
    // Load and display publications from JSON file
    document.addEventListener('DOMContentLoaded', function() {
        fetch('publications.json')
            .then(response => response.json())
            .then(data => {
                const publicationsList = document.getElementById('publications-list');
                if (!publicationsList) {
                    console.error('Publications list element not found');
                    return;
                }
                
                // Sort publications by date (newest first)
                const sortedPublications = data.publications
                    .sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Generate HTML for each publication
                sortedPublications.forEach(pub => {
                    const pubDiv = document.createElement('div');
                    pubDiv.className = 'publication';
                    
                    // Process authors to bold lab members
                    const processedAuthors = pub.authors.split(', ').map(author => {
                        const trimmedAuthor = author.trim();
                        if (pub.labMembers.includes(trimmedAuthor)) {
                            return `<span class="lab-member">${trimmedAuthor}</span>`;
                        }
                        return trimmedAuthor;
                    }).join(', ');
                    
                    // Create link boxes
                    let linkBoxes = '';
                    const linkTypes = {
                        'arxiv': { label: 'arXiv', class: 'pub-link-arxiv' },
                        'code': { label: 'Code', class: 'pub-link-code' },
                        'huggingface': { label: 'HuggingFace', class: 'pub-link-huggingface' },
                        'pdf': { label: 'PDF', class: 'pub-link-pdf' },
                        'blog': { label: 'Blog', class: 'pub-link-blog' }
                    };
                    
                    Object.entries(linkTypes).forEach(([key, config]) => {
                        if (pub.links[key] && pub.links[key].trim() !== '') {
                            linkBoxes += `<a href="${pub.links[key]}" target="_blank" rel="noopener noreferrer" class="pub-link-box ${config.class}">${config.label}</a>`;
                        }
                    });
                    
                    pubDiv.innerHTML = `
                        <span class="pub-year">${pub.displayDate}</span>
                        <h4 class="pub-title">${pub.title}</h4>
                        <p class="pub-authors">${processedAuthors}</p>
                        <p class="pub-venue">${pub.venue}</p>
                        ${linkBoxes ? `<div class="pub-links">${linkBoxes}</div>` : ''}
                    `;
                    
                    publicationsList.appendChild(pubDiv);
                });
            })
            .catch(error => {
                console.error('Error loading publications:', error);
                // Fallback content if publications fail to load
                const publicationsList = document.getElementById('publications-list');
                if (publicationsList) {
                    publicationsList.innerHTML = '<div class="publication"><p class="pub-authors">Unable to load publications at this time.</p></div>';
                }
            });
    });
  </script>
 </body>
</html>
